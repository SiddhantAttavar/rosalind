x = 'ACDEFGHIKLMNPQRSTVWY'
m = [
	[ 2,-2, 0, 0,-3, 1,-1,-1,-1,-2,-1, 0, 1, 0,-2, 1, 1, 0,-6,-3],
	[-2,12,-5,-5,-4,-3,-3,-2,-5,-6,-5,-4,-3,-5,-4, 0,-2,-2,-8, 0],
	[ 0,-5, 4, 3,-6, 1, 1,-2, 0,-4,-3, 2,-1, 2,-1, 0, 0,-2,-7,-4],
	[ 0,-5, 3, 4,-5, 0, 1,-2, 0,-3,-2, 1,-1, 2,-1, 0, 0,-2,-7,-4],
	[-3,-4,-6,-5, 9,-5,-2, 1,-5, 2, 0,-3,-5,-5,-4,-3,-3,-1, 0, 7],
	[ 1,-3, 1, 0,-5, 5,-2,-3,-2,-4,-3, 0, 0,-1,-3, 1, 0,-1,-7,-5],
	[-1,-3, 1, 1,-2,-2, 6,-2, 0,-2,-2, 2, 0, 3, 2,-1,-1,-2,-3, 0],
	[-1,-2,-2,-2, 1,-3,-2, 5,-2, 2, 2,-2,-2,-2,-2,-1, 0, 4,-5,-1],
	[-1,-5, 0, 0,-5,-2, 0,-2, 5,-3, 0, 1,-1, 1, 3, 0, 0,-2,-3,-4],
	[-2,-6,-4,-3, 2,-4,-2, 2,-3, 6, 4,-3,-3,-2,-3,-3,-2, 2,-2,-1],
	[-1,-5,-3,-2, 0,-3,-2, 2, 0, 4, 6,-2,-2,-1, 0,-2,-1, 2,-4,-2],
	[ 0,-4, 2, 1,-3, 0, 2,-2, 1,-3,-2, 2, 0, 1, 0, 1, 0,-2,-4,-2],
	[ 1,-3,-1,-1,-5, 0, 0,-2,-1,-3,-2, 0, 6, 0, 0, 1, 0,-1,-6,-5],
	[ 0,-5, 2, 2,-5,-1, 3,-2, 1,-2,-1, 1, 0, 4, 1,-1,-1,-2,-5,-4],
	[-2,-4,-1,-1,-4,-3, 2,-2, 3,-3, 0, 0, 0, 1, 6, 0,-1,-2, 2,-4],
	[ 1, 0, 0, 0,-3, 1,-1,-1, 0,-3,-2, 1, 1,-1, 0, 2, 1,-1,-2,-3],
	[ 1,-2, 0, 0,-3, 0,-1, 0, 0,-2,-1, 0, 0,-1,-1, 1, 3, 0,-5,-3],
	[ 0,-2,-2,-2,-1,-1,-2, 4,-2, 2, 2,-2,-1,-2,-2,-1, 0, 4,-6,-2],
	[-6,-8,-7,-7, 0,-7,-3,-5,-3,-2,-4,-4,-6,-5, 2,-2,-5,-6,17, 0],
	[-3, 0,-4,-4, 7,-5, 0,-1,-4,-1,-2,-2,-5,-4,-4,-3,-3,-2, 0,10],
]

d = {}
for i in range(len(m)):
	for j in range(len(m[i])):
		d[x[i] + x[j]] = m[i][j]

from utils import read_fasta

s, t = read_fasta().values()

dp = [[0] * (len(t) + 1) for _ in range(len(s) + 1)]
dp[0][0] = 0

for i in range(len(s)):
	dp[i + 1][0] = -5 * (i + 1)
for j in range(len(t)):
	dp[0][j + 1] = -5 * (j + 1)

for i in range(len(s)):
	for j in range(len(t)):
		dp[i + 1][j + 1] = max(
			0,
			dp[i][j + 1] - 5,
			dp[i + 1][j] - 5,
			dp[i][j] + d[s[i] + t[j]]
		)

x, y = 0, 0
for i in range(len(s) + 1):
	for j in range(len(t) + 1):
		if dp[i][j] > dp[x][y]:
			x, y = i, j

u, v = x, y
while dp[x][y] != 0:
	if x > 0 and dp[x][y] == dp[x - 1][y] - 5:
		x -= 1
		continue

	if y > 0 and dp[x][y] == dp[x][y - 1] - 5:
		y -= 1
		continue

	x -= 1
	y -= 1

print(dp[u][v])
print(s[x: u])
print(t[y: v])
